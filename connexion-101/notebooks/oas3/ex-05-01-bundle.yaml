openapi: 3.0.0
info:
  title: foo
  version: '0.1'
servers:
- description: Development server
  url: https://localhost:8443/datetime/v1
- description: Test server
  url: https://api.example.com/datetime/v1
  x-healthCheck:
    interval: 300
    timeout: 15
    url: https://api.example.com/datetime/v1/status
  x-sandbox: true
paths:
  /echo:
    get:
      description: |
        Return the current timestamp, in the specified
        timezone. If the timezone does not
        exist returns 400 Bad Request, specifying that
        the given timezone is not in our database.
      operationId: api.get_echo
      parameters:
      - $ref: '#/components/parameters/tz'
      responses:
        503:
          $ref: '#/components/responses/503ServiceUnavailable'
        '200':
          content:
            application/problem+json:
              example:
                datetime: 20010507T00:00:10Z
              schema:
                $ref: '#/components/schemas/Datetime'
          description: |
            The current timestamp.
        '400':
          $ref: '#/components/responses/400BadRequest'
      summary: Return the current timestamp in RFC3339
  /status:
    get:
      description: |
        Ritorna lo stato dell'applicazione. A scopo
        di test, su base randomica puo' ritornare
        un errore.
      operationId: api.get_status
      responses:
        503:
          $ref: '#/components/responses/503ServiceUnavailable'
        '200':
          content:
            application/problem+json:
              example:
                detail: The app is running smoothly.
                status: 200
                title: OK
              schema:
                $ref: '#/components/schemas/Problem'
          description: |
            Il server ha ritornato lo status. In caso di problemi
            ritorna sempre un problem+json.
      summary: Ritorna lo stato dell'applicazione.
components:
  headers:
    Retry-After:
      description: |-
        Retry contacting the endpoint *at least* after seconds.
        See https://tools.ietf.org/html/rfc7231#section-7.1.3
      schema:
        format: int32
        type: integer
  parameters:
    tz:
      in: query
      name: tz
      schema:
        $ref: '#/components/schemas/Timezone'
  responses:
    400BadRequest:
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/Problem'
      description: Bad Request
    503ServiceUnavailable:
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/Problem'
      description: Service Unavailable
      headers:
        Retry-After:
          $ref: '#/components/headers/Retry-After'
  schemas:
    Datetime:
      properties:
        timestamp:
          example: 2019-01-01 00:00:00
          format: datetime
          type: string
      required:
      - timestamp
    Problem:
      properties:
        detail:
          description: |
            A human readable explanation specific to this occurrence of the
            problem. You MUST NOT expose internal informations, personal
            data or implementation details through this field.
          example: Request took too long to complete.
          type: string
        instance:
          description: |
            An absolute URI that identifies the specific occurrence of the problem.
            It may or may not yield further information if dereferenced.
          format: uri
          type: string
        status:
          description: |
            The HTTP status code generated by the origin server for this occurrence
            of the problem.
          example: 503
          exclusiveMaximum: true
          format: int32
          maximum: 600
          minimum: 100
          type: integer
        title:
          description: |
            A short, summary of the problem type. Written in english and readable
            for engineers (usually not suited for non technical stakeholders and
            not localized); example: Service Unavailable
          type: string
        type:
          default: about:blank
          description: |
            An absolute URI that identifies the problem type.  When dereferenced,
            it SHOULD provide human-readable documentation for the problem type
            (e.g., using HTML).
          example: https://tools.ietf.org/html/rfc7231#section-6.6.4
          format: uri
          type: string
      type: object
    Timezone:
      description: |
        A timezone in the form of continent/city
        or "UTC".
      example: Europe/Rome
      type: string
